@using Microsoft.AspNetCore.Identity
@using TradesCompany.Domain.Entities
@inject SignInManager<ApplicationUser> SignInManager
@using Microsoft.IdentityModel.Claims
@{
    string userId = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
    string userRole = User.FindFirst(ClaimTypes.Role)?.Value;
    string userName = User.FindFirst(ClaimTypes.Name)?.Value.ToUpper();
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - TradesCompany.Web</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/TradesCompany.Web.styles.css" asp-append-version="true" />
    <meta charset="utf-8" />
    <title>Trades Company</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
          href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900" />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>
<body>
            <input value="@userId" type="hidden" id="userId" />
            <header class="flex items-center align-items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f0f2f5] px-10 py-3">
                <div class="flex items-center justify-between gap-6 px-4 py-2 bg-white rounded-lg shadow-sm text-[#111418]">

            <!-- Icon + Title -->
            <div class="flex items-center gap-3">
                <div class="w-6 h-6 text-primary">
                    <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full text-[#4B5563]">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z"
                              fill="currentColor" />
                    </svg>
                </div>
                <a asp-action="Dashboard" asp-controller="Employee"
                   class="text-lg font-semibold text-[#111418] hover:text-primary transition duration-200">
                    Home Services
                </a>
            </div>

            <!-- User Info -->
            <div class="text-sm font-medium text-gray-600">
                @userRole<span class="mx-1 text-gray-400">|</span>@userName
            </div>
        </div>


        <div class="flex gap-8 justify-content-center align-items-center">

            @if (SignInManager.IsSignedIn(User))
            {
                <a asp-controller="Employee" asp-action="AllQuotation">All Quotation</a>
                <a asp-controller="Employee" asp-action="MyScheduleServices">Scheduled Services</a>
                <a asp-controller="Chat" asp-action="UserListing"
                   class="relative flex items-center gap-2 px-4 py-2 h-10 rounded-full bg-white text-sm font-semibold text-gray-800 hover:bg-gray-100 hover:shadow transition duration-300 cursor-pointer">
                   <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 24 24"
                        class="text-gray-700 group-hover:text-black transition-colors duration-300">
                       <path d="M20 2H4C2.9 2 2 2.9 2 4v14l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                   </svg>
                   <span>Chat</span>
                   <span id="chatnotificationcnt"
                         class="text-xs font-bold text-white bg-red-500 rounded-full w-5 h-5 flex items-center justify-center animate-pulse absolute -top-1 -right-1">
                   </span>
                </a>

                <a asp-action="Notification" asp-controller="Employee"
                   class="group flex items-center gap-2 px-4 py-2 h-10 max-w-[480px] rounded-full bg-white shadow-sm hover:shadow-md transition-shadow duration-300 text-sm font-semibold text-gray-800 hover:bg-gray-100 cursor-pointer">
                    <div class="relative flex items-center gap-2">
                        <span id="notificationcnt"
                              class="text-xs font-bold text-white bg-red-500 rounded-full w-5 h-5 flex items-center justify-center animate-pulse">
                        </span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                             fill="currentColor"
                             viewBox="0 0 256 256"
                             class="text-gray-700 group-hover:text-black transition-colors duration-300">
                            <path d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z" />
                        </svg>
                    </div>
                </a>
   
                <a asp-controller="Account" asp-action="Logout">Logout</a>   
            }
            else
            {
                <a asp-controller="Account" asp-action="Login">Login</a>
            }

    </header>

    <div class="container">
        <main role="main" class="pb-3 mt-3">
            @RenderBody()
            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger alert-custom alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    @TempData["ErrorMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success alert-custom alert-dismissible fade show" role="alert">
                    <i class="fas fa-check-circle me-2"></i>
                    @TempData["SuccessMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
        </main>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/signalr.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
